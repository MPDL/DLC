<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:mpdl="http://java.sun.com/jsf/composite/components/mpdl"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:ca="http://java.sun.com/jsf/composite/components/infiniteCarousel"
	xmlns:pretty="http://ocpsoft.com/prettyfaces"
	xmlns:view="http://java.sun.com/jsf/composite/components/mpdl/view">


<ui:composition template="templates/template_v3.xhtml">

	<ui:define name="mainContent">
	<style type="text/css">
    	.noBackground { background-image:none !important; background-color:transparent !important; border:none;}
    	.noPaddingTop {padding-top:0 !important;}
     </style>
	<mpdl:paginator paginatorBean="#{ingestLogBean}">
		<h:panelGroup layout="block">
		    <rich:dataTable var="log" value="#{ingestLogBean.logs}"  styleClass="eg3_container_1" rendered="#{not empty ingestLogBean.logs}">
		        <f:facet name="header">
		            <rich:columnGroup>
		                <rich:column>
		                	<h:outputText value="#{lbl.batch_ingest_log_name}"/>
		                </rich:column>
		                <rich:column>
		                    <h:outputText value="#{lbl.batch_ingest_log_step}"/>
		                </rich:column>
		                <rich:column>
		                    <h:outputText value="#{lbl.batch_ingest_log_status}"/>
		                </rich:column>
		                <rich:column >
		                    <h:outputText value="#{lbl.batch_ingest_log_errorlevel}"/>
		                </rich:column>
		                <rich:column >
		                    <h:outputText value="#{lbl.batch_ingest_log_logs}"/>
		                </rich:column>
		                <rich:column>
		                    <h:outputText value="#{lbl.batch_ingest_log_startdate}"/>
		                </rich:column>
		                <rich:column>
		                    <h:outputText value="#{lbl.batch_ingest_log_enddate}"/>
		                </rich:column>
		                <rich:column >
		                    <h:outputText value="#{lbl.batch_ingest_log_context}"/>
		                </rich:column>
		                <rich:column>
		                    <h:outputText value="#{lbl.batch_ingest_log_totalItems}"/>
		                </rich:column>		                
		                <rich:column>
		                    <h:outputText value="#{lbl.batch_ingest_log_finished_items}"/>
		                </rich:column>
	                	             
		            </rich:columnGroup>
		        </f:facet>
		        
		        <rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.name}" />
       			</rich:column>
		        <rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.step}"/>
       			</rich:column>
       			<rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.status}"/>
       			</rich:column>
		        <rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.errorLevel}"/>           		
       			</rich:column>
 		       	
 		       	<rich:column style="vertical-align:top;" rendered="#{not empty log.logs}">
		       		<span onclick="$(this).next().toggle();">
		       			<h:outputText value="#{lbl.batch_ingest_show_hide_logs}" />
		       		</span>
		       		<div style="display:none; width:100%; clear:both;">
 		        	<a4j:repeat value= "#{log.logs}" var="logLog" >
            			<h:outputText value="#{logLog}&lt;br /&gt;" escape="false" >
            				<br/>
            			</h:outputText>  
            		</a4j:repeat>
            		</div>
       			</rich:column>
       			<rich:column style="vertical-align:top;" rendered="#{empty log.logs}">
       				<h:outputText value="" />
       			</rich:column>
       			  			
       			<rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.startDate}"/>
       			</rich:column>
		        <rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.endDate}"/>
       			</rich:column>
       			<rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.contextName}"/>
       			</rich:column>
       			<rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.totalItems}"/>
       			</rich:column>
		        <rich:column style="vertical-align:top;">
            		<h:outputText value="#{log.finishedItems}"/>
       			</rich:column>

       			
       			
 			    <rich:column colspan="12" breakRowBefore="true" style="padding-top:0; padding-bottom:0.5em;" rendered="#{log.totalItems > 0}">
					<rich:collapsiblePanel id="colPan" header="#{lbl.batch_ingest_log_show_hide_items}" switchType="client" expanded="false" styleClass="eg3_container_1 noBackground" bodyClass="eg3_container_1 noPaddingTop" headerClass="noPaddingTop eg3_container_1 noBackground" style="padding-top:0;">
						<rich:dataTable var="logItem" value="#{ingestLogBean.getLogItems(log)}" style="vertical-align:top;" styleClass="eg3_container_1">
							<f:facet name="header">
					            <rich:columnGroup>
									<rich:column>
					                	<h:outputText value="#{lbl.batch_ingest_log_name}"/>
					                </rich:column>
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_step}"/>
					                </rich:column>
					                <rich:column >
					                    <h:outputText value="#{lbl.batch_ingest_log_errorlevel}"/>
					                </rich:column>
					                <rich:column >
					                    <h:outputText value="#{lbl.batch_ingest_log_logs}"/>
					                </rich:column>
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_startdate}"/>
					                </rich:column>
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_enddate}"/>
					                </rich:column>
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_title}"/>
					                </rich:column>			                
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_content_model}"/>
					                </rich:column>		                
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_imagesNr}"/>
					                </rich:column>
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_footer}"/>
					                </rich:column>
					                <rich:column>
					                    <h:outputText value="#{lbl.batch_ingest_log_tei}"/>
					                </rich:column>
					            </rich:columnGroup>
					        </f:facet>    	
					        
					        <rich:column breakRowBefore="true" style="vertical-align:top;">
								<h:outputText value="#{logItem.name}"/>
							</rich:column>
							
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.step}"/>
							</rich:column>
							
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.errorLevel}"/>
							</rich:column>
							
							<rich:column style="vertical-align:top; width:30%;" rendered="#{not empty logItem.logs}">
					       		<span onclick="$(this).next().toggle();">
					       			<h:outputText value="#{lbl.batch_ingest_show_hide_logs}" />
					       		</span>
								<div style="display:none; width:100%; clear:both;">
									<a4j:repeat value= "#{logItem.logs}" var="logItemLog" >
										<h:outputText value="#{logItemLog}&lt;br /&gt;" escape="false"/>
									</a4j:repeat>
								</div>
							</rich:column>
							
							<rich:column style="vertical-align:top; width:30%;" rendered="#{empty logItem.logs}">
								<h:outputText value=""/>
							</rich:column>
							
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.startDate}"/>
							</rich:column>
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.endDate}"/>
							</rich:column>

							<rich:column style="vertical-align:top; width:5em;" rendered="#{not empty logItem.escidocId and logItem.content_model != applicationBean.cmMultiVol}">
								<pretty:link mappingId = "viewPages">
									<f:param value="#{logItem.escidocId}"/>
									<f:param value="recto-verso"/>
									<f:param value="1"/>
									<h:outputText value="#{logItem.shortTitle}"/>
								</pretty:link>
							</rich:column>
							
							<rich:column style="vertical-align:top;" rendered="#{not empty logItem.escidocId and logItem.content_model == applicationBean.cmMultiVol}">
								<h:outputText value="#{logItem.shortTitle}"/>
							</rich:column>

							
							<rich:column rendered="#{empty logItem.escidocId}" style="vertical-align:top;">
								<h:outputText value=""/>
							</rich:column>
							
					        <rich:column rendered="#{logItem.content_model != applicationBean.cmMultiVol}" style="vertical-align:top;">
			            		<h:outputText value="#{lbl.monograph}"/>
			       			</rich:column>
			       			<rich:column rendered="#{logItem.content_model == applicationBean.cmMultiVol}" style="vertical-align:top;">
			            		<h:outputText value="#{lbl.multivolume}"/>
			       			</rich:column>
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.images_nr}"/>
							</rich:column>
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.fFileName}"/>
							</rich:column>
							<rich:column style="vertical-align:top;">
								<h:outputText value="#{logItem.teiFileName}"/>
							</rich:column>
							
							<rich:column colspan="12" breakRowBefore="true" style="padding-top:0; padding-bottom:0.5em;" rendered="#{logItem.content_model == applicationBean.cmMultiVol and not empty ingestLogBean.getLogItemVolumes(logItem)}">
			       				<rich:collapsibleSubTableToggler for="logItemVolume" colspan="16">
			       					<h:outputText value="#{lbl.batch_ingest_log_show_hide_items}"/>
			       				</rich:collapsibleSubTableToggler>
			       			</rich:column>
			       			
			       			<rich:collapsibleSubTable style="border:1px" var="logItemVolume" id="logItemVolume" value="#{ingestLogBean.getLogItemVolumes(logItem)}" rendered="#{logItem.content_model == applicationBean.cmMultiVol and not empty ingestLogBean.getLogItemVolumes(logItem)}" expanded="#{false}" expandMode="client">

								<rich:column breakRowBefore="true" style="vertical-align:top">
									<h:outputText value="#{logItemVolume.name}"/>
								</rich:column>
								
								<rich:column style="vertical-align:top">
									<h:outputText value="#{logItemVolume.step}"/>
								</rich:column>
								
								<rich:column style="vertical-align:top;border:1px">
									<h:outputText value="#{logItemVolume.errorLevel}"/>
								</rich:column>
								
								<rich:column style="vertical-align:top; width:30%;" rendered="#{not empty logItemVolume.logs}">
						       		<span onclick="$(this).next().toggle();">
						       			<h:outputText value="#{lbl.batch_ingest_show_hide_logs}" />
						       		</span>
									<div style="display:none; width:100%; clear:both;">
										<a4j:repeat value= "#{logItemVolume.logs}" var="logItemVolumeLog" >
											<h:outputText value="#{logItemVolumeLog}&lt;br /&gt;" escape="false"/>
										</a4j:repeat>
									</div>
								</rich:column>
								
								<rich:column style="vertical-align:top; width:30%;" rendered="#{empty logItemVolume.logs}">
									<h:outputText value=""/>
								</rich:column>
								
								<rich:column style="vertical-align:top;">
									<h:outputText value="#{logItemVolume.startDate}"/>
								</rich:column>
								<rich:column style="vertical-align:top;">
									<h:outputText value="#{logItemVolume.endDate}"/>
								</rich:column>

								<rich:column rendered="#{not empty logItemVolume.escidocId}" style="vertical-align:top;">
									<pretty:link mappingId = "viewPages">
										<f:param value="#{logItemVolume.escidocId}"/>
										<f:param value="recto-verso"/>
										<f:param value="1"/>
										<h:outputText value="#{logItemVolume.shortTitle}"/>
									</pretty:link>
								</rich:column>
								<rich:column rendered="#{empty logItemVolume.escidocId}" style="vertical-align:top;">
									<h:outputText value="#{logItemVolume.escidocId}"/>
								</rich:column>
								<rich:column style="vertical-align:top;">
									<h:outputText value="#{lbl.volume}"/>
								</rich:column>
								<rich:column style="vertical-align:top;">
									<h:outputText value="#{logItemVolume.images_nr}"/>
								</rich:column>
								<rich:column style="vertical-align:top;">
									<h:outputText value="#{logItemVolume.fFileName}"/>
								</rich:column>
								<rich:column style="vertical-align:top;">
									<h:outputText value="#{logItemVolume.teiFileName}"/>
								</rich:column>							
							</rich:collapsibleSubTable>
							
						</rich:dataTable>
						
					</rich:collapsiblePanel>
				</rich:column>
					        
     	


				
			</rich:dataTable>
		</h:panelGroup>
	</mpdl:paginator>
	</ui:define>
</ui:composition>

</html>