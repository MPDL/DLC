<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:list="http://java.sun.com/jsf/composite/components/mpdl/list"
	xmlns:mpdl="http://java.sun.com/jsf/composite/components/mpdl"
	xmlns:pretty="http://ocpsoft.com/prettyfaces">


	<!-- INTERFACE -->
	<cc:interface>
		<cc:attribute name="volume" required="true"/>
		<cc:attribute name="rendered" required="false"/>
		<cc:attribute name="fulltextHits"/>
	</cc:interface>
	
	<!-- IMPLEMENTATION -->
	<cc:implementation>
		
		<h:panelGroup layout="block" styleClass="eg3_listItemMultiVolume eg3_multiVolumeBG_1" rendered="#{cc.attrs.rendered}">
		
	   		<mpdl:mvPlayer target="popupMV" vol="#{cc.attrs.volume}"/>
			
			<h:panelGroup layout="block" styleClass="eg3_itemContent">
				<h:panelGroup layout="block" styleClass="eg3_itemContentData">
					<h:panelGroup layout="block" styleClass="eg3_itemStatusArea" >
						<h:panelGroup styleClass="eg3_icon_privateDocument_32_32" title="#{tlt.list_status}" rendered="#{cc.attrs.volume.item.properties.version.status=='pending'}">&nbsp;</h:panelGroup>
						<h:panelGroup styleClass="eg3_icon_publishDocument_32_32" title="#{tlt.list_status}" rendered="#{cc.attrs.volume.item.properties.version.status=='released'}">&nbsp;</h:panelGroup>
						<h:panelGroup styleClass="eg3_itemStatusTitle">
							<h:outputText value="#{lbl.status_pending}" rendered="#{cc.attrs.volume.item.properties.version.status=='pending'}"/>
							<h:outputText value="#{lbl.status_released}" rendered="#{cc.attrs.volume.item.properties.version.status=='released'}"/>
						</h:panelGroup>
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="eg3_itemHeadline">
						<h:panelGroup layout="block" styleClass="eg3_itemTitle">
							<h:panelGroup rendered="#{not empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}">
								<h:outputText value="#{volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}: " rendered="#{not empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}"/>
							</h:panelGroup>	
				            
			            	<a4j:commandLink value="#{volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title}" execute="@this" render="mvPlayer" oncomplete="#{rich:component('popupMV')}.show()" rendered="#{not empty volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title}">
				               	<ui:remove>											
									<h:outputText value="#{volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title}" rendered="#{not empty volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title}"/>
								</ui:remove>
								
								<h:panelGroup rendered="#{empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}">
									<h:outputText value=" / #{volumeUtilBean.getFirstEditor(cc.attrs.volume.modsMetadata).name} (#{lbl.view_dtls_editor_suffix}.)" rendered="#{not empty volumeUtilBean.getFirstEditor(cc.attrs.volume.modsMetadata).name}"/>
								</h:panelGroup>
							</a4j:commandLink>
							
							<a4j:commandLink value="#{lbl.na_no_volume_title}" execute="@this" render="mvPlayer" oncomplete="#{rich:component('popupMV')}.show()" rendered="#{empty volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title}">
								<h:panelGroup rendered="#{empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}">
									<h:outputText value=" / #{volumeUtilBean.getFirstEditor(cc.attrs.volume.modsMetadata).name} (#{lbl.view_dtls_editor_suffix}.)" rendered="#{not empty volumeUtilBean.getFirstEditor(cc.attrs.volume.modsMetadata).name}"/>
								</h:panelGroup>
							</a4j:commandLink>
							
							<br/>
							<h:outputText value="#{volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).place} : " rendered="#{not empty volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).place}"/>
							<h:outputText value="#{volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).publisher}, " rendered="#{not empty volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).publisher}"/>
						</h:panelGroup> 
					</h:panelGroup>
					
					<h:panelGroup layout="block" styleClass="eg3_shortView_js">
						<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel"><h:outputText value="#{lbl.list_NumberOfVolumes}"/></h:panelGroup>
						<h:panelGroup layout="block" styleClass="eg3_itemMetaValue"><h:outputText value="#{volumeUtilBean.getSize(cc.attrs.volume.relatedChildVolumes)}"/></h:panelGroup>
						
						<ui:fragment rendered="#{prettyContext.currentMapping.id == 'volumes' and allVolumesBean.colId == 'my'}">
							<h:panelGroup styleClass="eg3_verticalSpace_row_1"><h:outputText value="&#160;"/></h:panelGroup>
							
							<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel"><h:outputText value="#{lbl.list_lastModified}"/></h:panelGroup>
							<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
								<pretty:link mappingId="viewPages">
									<f:param value="#{cc.attrs.volume.objidAndVersion}"/>
									<f:param value="recto-verso"/>
									<f:param value="1"/>
									<h:outputText value="#{cc.attrs.volume.item.properties.latestVersion.date.toDate()}">
										<f:convertDateTime pattern="#{utilBean.standardDateTimePattern}"/>
									</h:outputText>
									<h:outputText value=" (Version #{cc.attrs.volume.item.properties.latestVersion.number})"/>
								</pretty:link>
								
								<h:panelGroup rendered="#{cc.attrs.volume.item.properties.version.status=='pending' and loginBean.user.releasable(cc.attrs.volume.item.properties.context.objid)}">
									<h:commandButton action="#{allVolumesBean.release(cc.attrs.volume)}" value="#{lbl.button_command_release}" styleClass="eg3_borderradius_5"/>
								</h:panelGroup>
							</h:panelGroup>
							
							<h:panelGroup rendered="#{not empty cc.attrs.volume.item.properties.latestRelease}">
								<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel"><h:outputText value="#{lbl.list_lastReleased}"/></h:panelGroup>
								<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
								<pretty:link mappingId="viewPages">
									<f:param value="#{cc.attrs.volume.item.properties.latestRelease.objid}"/>
									<f:param value="recto-verso"/>
									<f:param value="1"/>
									
									<h:outputText value="#{cc.attrs.volume.item.properties.latestRelease.date.toDate()}"> 
										<f:convertDateTime pattern="#{utilBean.standardDateTimePattern}"/>
									</h:outputText>
									<h:outputText value=" (Version #{cc.attrs.volume.item.properties.latestRelease.number})"/>
								</pretty:link>
								</h:panelGroup>
							</h:panelGroup>
							
							<h:panelGroup styleClass="eg3_verticalSpace_row_1"><h:outputText value="&#160;"/></h:panelGroup>
							
							<!-- update dataset -->
							<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel">&#160;</h:panelGroup>
							<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
								<pretty:link mappingId="upload" styleClass="eg3_icon_editBtni_16_16">
									<f:param value="#{cc.attrs.volume.item.originObjid}"/>
									<h:outputText value="#{lbl.list_NavElem_Edit} #{list_NavElem_Reingest}"/>
								</pretty:link>
							</h:panelGroup>
						</ui:fragment>
					</h:panelGroup>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="eg3_itemMediabar">
					<h:panelGroup layout="block" styleClass="eg3_itemContentOptions">
						<h:panelGroup layout="block" styleClass="eg3_itemDetailAction_js">
							<h:panelGroup layout="block" styleClass="eg3_icon_collapse_16_16" >
								<label class="eg3_iconActionLabel">
									<h:outputText value="#{lbl.list_NavElem_More}"/>
								</label>
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
		</h:panelGroup>
		
		<h:panelGroup layout="block" rendered="#{cc.attrs.volume.item.properties.contentModel.objid == applicationBean.cmMultiVol}">
			<list:bibItemVolume volumes="#{cc.attrs.volume.relatedChildVolumes}"/>
	    </h:panelGroup>

	</cc:implementation>
</html>