<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:list="http://java.sun.com/jsf/composite/components/mpdl/list"
	xmlns:pretty="http://ocpsoft.com/prettyfaces">


<!-- INTERFACE -->
<cc:interface>

	<cc:attribute name="volume" required="true"/>
		<cc:attribute name="rendered" required="false" />
	<cc:attribute name="fulltextHits"/>
	
</cc:interface>

<!-- IMPLEMENTATION -->
<cc:implementation>

		<h:panelGroup layout="block" class="eg3_listItemMultiVolume eg3_multiVolumeBG_3"  rendered="#{cc.attrs.rendered}">
			
			<div class="eg3_itemContent">
				<div class="eg3_itemContentData">
					<div class="eg3_itemStatusArea">
						<div class="eg3_icon_withdrawn_32_32" title="???placeholder???">&nbsp;</div>
						<h:panelGroup class="eg3_itemStatusTitle">
							<h:outputText value="#{cc.attrs.volume.item.properties.version.status}" />
						</h:panelGroup>
					</div>
					<div class="eg3_itemHeadline">
						<div class="eg3_itemTitle">
							<pretty:link mappingId="viewMultiVol">
								<f:param value="#{cc.attrs.volume.objidAndVersion}" />
								<f:param name="fm" value="#{cc.attrs.fulltextHits}" rendered="#{not empty cc.attrs.fulltextHits}"/>
							
								<h:outputText value="#{volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}: #{volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title}. - #{volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).place} : #{volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).publisher}" rendered="#{not empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}" />
								<h:outputText value="#{volumeUtilBean.getTitle(cc.attrs.volume.modsMetadata).title} / #{volumeUtilBean.getFirstEditor(cc.attrs.volume.modsMetadata).name} (#{lbl.view_dtls_editor_suffix}). - #{volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).place} : #{volumeUtilBean.getPublisher(cc.attrs.volume.modsMetadata).publisher}" rendered="#{empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.modsMetadata).name}" />

						</pretty:link>
						</div> 
					</div>
				
				
					
					<div class="eg3_shortView_js">
						<div class="eg3_itemMetaLabel"><h:outputText value="Number of Volumes"/></div>
						<div class="eg3_itemMetaValue"><h:outputText value="#{volumeUtilBean.getSize(cc.attrs.volume.relatedChildVolumes)}"/></div>
						
						<h:panelGroup layout="block" class="eg3_itemMetaLabel" rendered="#{prettyContext.currentMapping.id == 'searchResult'}">
							<h:outputText value="#{lbl.ViewItemFull_lblFulltextSearchResults}" />
						</h:panelGroup>
						<h:panelGroup layout="block" class="eg3_itemMetaValue" rendered="#{prettyContext.currentMapping.id == 'searchResult'}">
							<a4j:repeat value="#{cc.attrs.volume.searchResultHighlight}" var="highlight" >
								<h:panelGroup styleClass="EMPTYCLASS" rendered="#{highlight.type=='FULLTEXT'}">
									<ui:param name="pageNumber" value="#{volumeUtilBean.getPageNumberForPageId(cc.attrs.volume, highlight.objid)}"/>
									
									<pretty:link mappingId="viewPages">
										<f:param value="#{cc.attrs.volume.item.objid}"/>
										<f:param value="recto-verso" />
										<f:param value="#{pageNumber}"/>
										<f:param name="fm" value="#{cc.attrs.fulltextHits}" rendered="#{not empty cc.attrs.fulltextHits}"/>
										<h:outputText value="Scan #{pageNumber}"/>
									</pretty:link>
									
									<br/>
									<a4j:repeat var="textFragment" value="#{highlight.textFragments}" >
										<h:outputText value="#{volumeUtilBean.emphasizeWordsinTextFragment(textFragment, 'searchHit')}" escape="false"/>
										<br/><br/>
									</a4j:repeat>
									<br/><br/>
								</h:panelGroup>
							</a4j:repeat>
						</h:panelGroup>					
					</div>
				</div>
			
				<div class="eg3_itemMediabar">
					<div class="eg3_itemContentOptions">
						<div class="eg3_itemDetailAction_js" title="???placeholder???">
							<h:panelGroup class="eg3_icon_collapse_16_16" rendered="#{volumeUtilBean.getSize(cc.attrs.volume.relatedChildVolumes) > 0}">
								<label class="eg3_iconActionLabel" >More / Less</label>
							</h:panelGroup>
						</div>
						
						<h:panelGroup layout="block" class="eg3_itemMediabarCategory" rendered="#{allVolumesBean.contextId == 'my'}">
							<pretty:link mappingId="upload">
								<f:param value="#{cc.attrs.volume.item.objid}" />
								<h:outputText value="Reingest/edit" />
							</pretty:link>
						</h:panelGroup>
						
						<h:panelGroup layout="block" class="eg3_itemMediabarCategory" rendered="#{allVolumesBean.contextId == 'my' and cc.attrs.volume.item.properties.version.status=='pending'}">
							<h:commandButton action="#{allVolumesBean.release(cc.attrs.volume)}" value="#{lbl.release}" />
						</h:panelGroup>
						
					</div>
				</div>
			</div>
		</h:panelGroup>

		<h:panelGroup layout="block" rendered="#{cc.attrs.volume.item.properties.contentModel.objid == applicationBean.cmMultiVol}">
	 	   <list:bibItemVolume volumes="#{cc.attrs.volume.relatedChildVolumes}" />
	    </h:panelGroup>
	
	</cc:implementation>
</html>