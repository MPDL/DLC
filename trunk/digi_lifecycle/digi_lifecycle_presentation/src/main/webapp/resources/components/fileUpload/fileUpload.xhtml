<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<!-- INTERFACE -->
<cc:interface componentType="de.mpg.mpdl.jsf.components.FileUploadComponent">
	<cc:attribute name="fileUploadListener" method-signature="void method(de.mpg.mpdl.jsf.components.fileUpload.FileUploadEvent)" required="true"/>
	<cc:attribute name="rerender" type="java.lang.String"/>
</cc:interface>

<!-- IMPLEMENTATION -->
<cc:implementation>
	
<!-- 
	<h:form id="form" prependId="false">
		<h3>Choose file(s)</h3>
		<p><input id="files-upload" type="file"/></p>
		<p id="drop-area"><span class="drop-instructions">or drag
		and drop files here</span> <span class="drop-over">Drop files here!</span></p>

		<ul id="file-list">
			<li class="no-items">(no files uploaded yet)</li>
		</ul>

	</h:form>
-->

	<!-- 
	<link href="#{facesContext.externalContext.request.contextPath}/resources/components/fileUpload/plupload/styles/plupload.queue.css" type="text/css" rel="stylesheet"/>
	-->
	<h:outputStylesheet library="components/fileUpload/plupload/img" />
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script> 
	<h:outputScript library="components/fileUpload/plupload" name="gears_init.js"/>
	<script type="text/javascript" src="http://bp.yahooapis.com/2.4.21/browserplus-min.js"></script>
	<!-- Load source versions of the plupload script files -->
	<h:outputScript library="components/fileUpload/plupload" name="plupload.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="plupload.gears.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="plupload.silverlight.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="plupload.flash.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="plupload.browserplus.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="plupload.html5.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="plupload.html4.js"/>
	<h:outputScript library="components/fileUpload/plupload" name="jquery.plupload.queue.js"/>
    <h:outputScript library="components/fileUpload" name="plupload_custom.js"/>
    
    <script type="text/javascript">
			$(function(){
				initUploader('#{cc.clientId}', '#{cc.attrs.rerender}', getViewState(), '#{session.id}', '#{facesContext.externalContext.request.contextPath}#{facesContext.viewRoot.viewId}', '#{facesContext.externalContext.request.contextPath}/resources/components/fileUpload/plupload/plupload.flash.swf')
			})
			
			function getViewState()
			{
				
				if(document.getElementsByName('javax.faces.ViewState')[0])
				{
					
					var viewStateValue = encodeURI(document.getElementsByName('javax.faces.ViewState')[0].value);
					var regExp = new RegExp('\\+','g');
					var encodedViewState = viewStateValue.replace(regExp, '\%2B');
					return encodedViewState;
				}
				else
				{
					return '';
				}
				
			}
    </script>

<h:form>

		<div id="#{cc.clientId}">

		 	<div id="pluploader" style="width: 450px; height: 330px;">You browser doesn't have a HTML 4 browser.</div>
			
		 	
			<!-- 
			<ui:remove>
				<div id="filelist">No runtime found.</div>
				<br />
				<div id="dropArea" style="background-color: lightblue; width:100px; height:100px;">Drop Files Here</div>
				<a id="pickfiles" href="#">[Select files]</a> 
				<a id="uploadfiles" href="#">
					<h:outputText value="[Upload files]"/>
					
				</a>
	</ui:remove>		 
-->
<!-- 
			<h:commandButton  id="hiddenUploadCompleteButton" styleClass="hiddenUploadCompleteButton" value="hidden">
				<f:ajax event="click" render="#{cc.attrs.rerender}"/>
			</h:commandButton>
-->
		
		
	    </div>
	    </h:form>
	
	
	
	



</cc:implementation>
</html>