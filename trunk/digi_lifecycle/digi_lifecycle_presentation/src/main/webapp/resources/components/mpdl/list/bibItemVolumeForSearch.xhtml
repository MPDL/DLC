<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:mpdl="http://java.sun.com/jsf/composite/components/mpdl"
	xmlns:list="http://java.sun.com/jsf/composite/components/mpdl/list"
	xmlns:pretty="http://ocpsoft.com/prettyfaces">


	<!-- INTERFACE -->
	<cc:interface>
		<cc:attribute name="volume" required="true"/>
		<cc:attribute name="rendered" required="false"/>
		<cc:attribute name="fulltextHits"/>
	</cc:interface>
	
	<!-- IMPLEMENTATION -->
	<cc:implementation>

		<h:panelGroup layout="block" styleClass="eg3_listItemSingleVolume" rendered="#{cc.attrs.rendered}">
			<h:panelGroup layout="block" styleClass="eg3_itemContentBg"><h:outputText value="&#160;"/></h:panelGroup>
			<h:panelGroup layout="block" styleClass="eg3_itemContent">
				<h:panelGroup layout="block" styleClass="eg3_itemStatusArea">
					<h:panelGroup styleClass="eg3_icon_privateDocument_32_32" title="#{tlt.list_status}" rendered="#{cc.attrs.volume.item.properties.version.status=='pending' and empty cc.attrs.volume.item.properties.latestRelease}">&nbsp;</h:panelGroup>
					<h:panelGroup styleClass="eg3_icon_progressDocument_32_32" title="#{tlt.list_status}" rendered="#{cc.attrs.volume.item.properties.version.status=='pending' and not empty cc.attrs.volume.item.properties.latestRelease}">&nbsp;</h:panelGroup>
					<h:panelGroup styleClass="eg3_icon_publishDocument_32_32" title="#{tlt.list_status}" rendered="#{cc.attrs.volume.item.properties.version.status=='released'}">&nbsp;</h:panelGroup>
					
					<h:panelGroup styleClass="eg3_itemStatusTitle">
						<h:outputText value="#{lbl.status_pending}" rendered="#{cc.attrs.volume.item.properties.version.status=='pending' and empty cc.attrs.volume.item.properties.latestRelease}"/>
						<h:outputText value="#{lbl.status_inProgress}" rendered="#{cc.attrs.volume.item.properties.version.status=='pending' and not empty cc.attrs.volume.item.properties.latestRelease}"/>
						<h:outputText value="#{lbl.status_released}" rendered="#{cc.attrs.volume.item.properties.version.status=='released'}"/>
					</h:panelGroup>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="eg3_itemHeadline">
					<h:panelGroup layout="block" styleClass="eg3_itemTitle">
						<pretty:link mappingId="viewPages">
							<f:param value="#{cc.attrs.volume.objidAndVersion}"/>
							<f:param value="recto-verso"/>
							<f:param value="1"/>
							<f:param name="fm" value="#{cc.attrs.fulltextHits}" rendered="#{not empty cc.attrs.fulltextHits}"/>

							<h:outputText value="#{lbl.list_volume}. #{volumeUtilBean.getMainTitle(volume.modsMetadata).title}. - #{volumeUtilBean.getPublisher(volume.modsMetadata).dateIssued_425.date}."/>
						</pretty:link>
					</h:panelGroup>
					<!-- Multivolume title -->
					
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="eg3_shortView_js">
					<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel">
						<h:outputText value="#{lbl.list_parent}: "/>
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
						<!-- <pretty:link mappingId="viewMultiVol">
							<f:param value="#{cc.attrs.volume.item.relations[0].objid}"/>
						 -->		
							<h:outputText value="#{volumeUtilBean.getFirstAuthor(cc.attrs.volume.relatedParentVolume.modsMetadata).name}: #{volumeUtilBean.getTitle(cc.attrs.volume.relatedParentVolume.modsMetadata).title}. - #{volumeUtilBean.getPublisher(cc.attrs.volume.relatedParentVolume.modsMetadata).place} : #{volumeUtilBean.getPublisher(cc.attrs.volume.relatedParentVolume.modsMetadata).publisher}, #{volumeUtilBean.getPublisher(cc.attrs.volume.relatedParentVolume.modsMetadata).dateIssued_425.date}" rendered="#{not empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.relatedParentVolume.modsMetadata).name}"/>
							<h:outputText value="#{volumeUtilBean.getTitle(cc.attrs.volume.relatedParentVolume.modsMetadata).title} / #{volumeUtilBean.getFirstEditor(cc.attrs.volume.relatedParentVolume.modsMetadata).name} (#{lbl.view_dtls_editor_suffix}). - #{volumeUtilBean.getPublisher(cc.attrs.volume.relatedParentVolume.modsMetadata).place} : #{volumeUtilBean.getPublisher(cc.attrs.volume.relatedParentVolume.modsMetadata).publisher}, #{volumeUtilBean.getPublisher(cc.attrs.volume.relatedParentVolume.modsMetadata).dateIssued_425.date}" rendered="#{empty volumeUtilBean.getFirstAuthor(cc.attrs.volume.relatedParentVolume.modsMetadata).name}"/>
						<!-- </pretty:link>
						 -->
					</h:panelGroup>
					
					<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel" rendered="#{prettyContext.currentMapping.id == 'searchResult'}">
						<h:outputText value="#{lbl.list_fulltextSearchResults} #{cc.attrs.volume.searchResultHighlightSize}"/>
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="eg3_itemMetaValue" rendered="#{prettyContext.currentMapping.id == 'searchResult'}">
						<a4j:repeat value="#{cc.attrs.volume.searchResultHighlight}" var="highlight" rows="3">
							<h:panelGroup layout="block" styleClass="eg3_container_1 eg3_fullTextSearchItem" rendered="#{highlight.type=='FULLTEXT'}">
								<ui:param name="pageNumber" value="#{volumeUtilBean.getPageNumberForPageId(cc.attrs.volume, highlight.objid)}"/>
								
								<pretty:link mappingId="viewPages">
									<f:param value="#{cc.attrs.volume.item.objid}"/>
									<f:param value="fulltext"/>
									<f:param value="#{pageNumber}"/>
									<f:param name="fm" value="#{cc.attrs.fulltextHits}" rendered="#{not empty cc.attrs.fulltextHits}"/>
									<h:outputText value="#{lbl.list_Scan} #{pageNumber}"/>
								</pretty:link>
								
								<a4j:repeat var="textFragment" value="#{highlight.textFragments}">
									<h:panelGroup layout="block" styleClass="eg3_container_1">
										<h:outputText value="#{volumeUtilBean.emphasizeWordsinTextFragment(textFragment, 'eg3_searchHit')}" escape="false"/>
									</h:panelGroup>
								</a4j:repeat>
							</h:panelGroup>
						</a4j:repeat>
					</h:panelGroup>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="eg3_mediumView_js" rendered="#{prettyContext.currentMapping.id == 'searchResult' and cc.attrs.volume.searchResultHighlightSize gt 3}">
					
					<h:panelGroup layout="block" styleClass="eg3_container_1 eg3_showHideMediumView_js" rendered="#{prettyContext.currentMapping.id == 'searchResult' and cc.attrs.volume.searchResultHighlightSize gt 3}">
						<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel">
							<h:outputText value="&#160;"/>
						</h:panelGroup>
						<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
							<a title="#{lbl.sc_show_allHits}" class="eg3_icon_forwardi_16_16">
								<h:panelGroup styleClass="eg3_iconActionLabel"><h:outputText value="#{lbl.sc_show_allHits}"/></h:panelGroup>
							</a>
						</h:panelGroup>
						<h:panelGroup layout="block" styleClass="eg3_verticalSpace_row_1"><h:outputText value="&#160;"/></h:panelGroup>
					</h:panelGroup>
					
					<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel">
						<h:outputText value="&#160;"/>
					</h:panelGroup>
					
					<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
						<a4j:repeat value="#{cc.attrs.volume.searchResultHighlight}" var="highlight" first="3">
							<h:panelGroup layout="block" styleClass="eg3_container_1 eg3_fullTextSearchItem" rendered="#{highlight.type=='FULLTEXT'}">
								<ui:param name="pageNumber" value="#{volumeUtilBean.getPageNumberForPageId(cc.attrs.volume, highlight.objid)}"/>
								
								<pretty:link mappingId="viewPages">
									<f:param value="#{cc.attrs.volume.objidAndVersion}"/>
									<f:param value="fulltext"/>
									<f:param value="#{pageNumber}"/>
									
									<f:param name="fm" value="#{cc.attrs.fulltextHits}" rendered="#{not empty cc.attrs.fulltextHits}"/>
									<h:outputText value="#{lbl.list_Scan} #{pageNumber}"/>
								</pretty:link>
								
								<a4j:repeat var="textFragment" value="#{highlight.textFragments}">
									<h:panelGroup layout="block" styleClass="eg3_container_1">
										<h:outputText value="#{volumeUtilBean.emphasizeWordsinTextFragment(textFragment, 'eg3_searchHit')}" escape="false"/>
									</h:panelGroup>
								</a4j:repeat>
								
							</h:panelGroup>
						</a4j:repeat>
					</h:panelGroup>
				</h:panelGroup>
				
				<h:panelGroup layout="block" styleClass="eg3_container_1 eg3_showHideMediumView_js" rendered="#{prettyContext.currentMapping.id == 'searchResult' and cc.attrs.volume.searchResultHighlightSize gt 3}">
					<h:panelGroup layout="block" styleClass="eg3_itemMetaLabel">
						<h:outputText value="&#160;"/>
					</h:panelGroup>
					<h:panelGroup layout="block" styleClass="eg3_itemMetaValue">
						<a title="#{lbl.sc_show_allHits}" class="eg3_icon_forwardi_16_16">
							<h:panelGroup styleClass="eg3_iconActionLabel"><h:outputText value="#{lbl.sc_show_allHits}"/></h:panelGroup>
						</a>
					</h:panelGroup>
				</h:panelGroup>
			</h:panelGroup>
			
			<h:panelGroup layout="block" styleClass="eg3_itemMediabar">
				<h:panelGroup layout="block" styleClass="eg3_itemMediabarThumb">
					<h:graphicImage value="#{volumeUtilBean.getImageServerUrl(cc.attrs.volume.pages[0].contentIds, 'THUMBNAIL')}" alt="" rendered="#{cc.attrs.volume.pages[0] != null}"/>
				</h:panelGroup>
				<br/>
				
				<h:panelGroup layout="block" styleClass="eg3_itemMediabarCategory" rendered="#{not empty cc.attrs.volume.item.properties.latestRelease and (cc.attrs.volume.item.properties.latestRelease.objid != cc.attrs.volume.objidAndVersion) and prettyContext.currentMapping.id == 'volumes' and allVolumesBean.colId == 'my'}">
					<pretty:link mappingId="viewPages">
							<f:param value="#{cc.attrs.volume.item.properties.latestRelease.objid}"/>
							<f:param value="recto-verso"/>
							<f:param value="1"/>
							<f:param name="fm" value="#{cc.attrs.fulltextHits}"/>
							<h:outputText value="#{lbl.list_LatestRelease}"/>
						</pretty:link>
				</h:panelGroup>
				
				
				<h:panelGroup layout="block" styleClass="eg3_itemMediabarCategory">
					<pretty:link mappingId="thumbnails">
						<f:param value="#{cc.attrs.volume.objidAndVersion}"/>
						<h:outputText value="#{lbl.list_Thumbnails}"/>
					</pretty:link>
				</h:panelGroup>
				

				<br/>
				<!--  
				<h:panelGroup layout="block" class="eg3_itemMediabarCategory">
					<pretty:link mappingId="viewMultiVol">
						<f:param value="#{cc.attrs.volume.item.relations[0].objid}"/>
						<h:outputText value="#{lbl.list_NavElemParent}"/>
					</pretty:link>
				</h:panelGroup>	
				-->			
			</h:panelGroup>
		</h:panelGroup>


</cc:implementation>
</html>