<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:fu="http://java.sun.com/jsf/composite/components/fileUpload"
	xmlns:mpdl="http://java.sun.com/jsf/composite/components/mpdl"
	xmlns:load="http://java.sun.com/jsf/composite/components/lazyLoad"
	xmlns:pretty="http://ocpsoft.com/prettyfaces">

	<ui:composition template="templates/template.xhtml">
	<ui:define name="mainContent">
	<style>

	/* span.double_area0:hover
	{
	width: 40em; 
	 opacity:0.9;
	}*/
	.rf-trn-hnd-exp
	{
	background-image:none;
	}

	.rf-trn-ico-exp
	{
	background-image:none;
	}
	
	.rf-trn-ico
	{
	width:0px;
	}
	</style>



		<h:panelGroup layout="block" styleClass="full_area0 fullItem">
			
			<div class="full_area0 itemHeader">
				<h:panelGroup styleClass="xLarge_area0 endline blockHeader" >
					&#160;	
				</h:panelGroup>
				<h:panelGroup styleClass="seperator" />
				<h:panelGroup styleClass="free_area0_p8 endline itemHeadline">
					<h:outputText value="Author"/>
					<br />
					<b>
							<h:outputText value="#{volumeUtilBean.getMainTitle(viewPages.volume.modsMetadata).title}"/>
					</b>
				</h:panelGroup>
			</div>
			
			<div class="full_area0 itemHeader">
				<h:panelGroup layout="block" styleClass="xHuge_marginLIncl pageBrowser">
					<h:commandButton value=" " action="#{viewPages.goToFirstPage}" styleClass="min_imgBtn groupBtn skipToFirst">
						<f:ajax render="@all"/>
					</h:commandButton>
					<h:commandButton value=" " action="#{viewPages.goToPreviousPage}" styleClass="min_imgBtn groupBtn backward">
						<f:ajax render="@all"/>
					</h:commandButton>
					<h:commandButton value=" " action="#{viewPages.goToNextPage}" styleClass="min_imgBtn groupBtn forward">
						<f:ajax render="@all"/>
					</h:commandButton>
					<h:commandButton value=" " action="#{viewPages.goToLastPage}" styleClass="min_imgBtn groupBtn skipToLast">
						<f:ajax render="@all"/>
					</h:commandButton>
					<h:commandButton value="Rerender" styleClass="min_imgBtn groupBtn">
						<f:ajax render="@all"/>
					</h:commandButton>
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="free_area0 xHuge_marginLIncl">
					<h:commandButton value="Zoom " action="#{viewPages.setViewType('SINGLE')}" styleClass="large_imgBtn groupBtn"/>
					<h:commandButton value="Recto/Verso " action="#{viewPages.setViewType('RECTO_VERSO')}" styleClass="large_imgBtn groupBtn"/>
					<h:commandButton value="Fulltext " action="#{viewPages.setViewType('FULLTEXT')}" styleClass="large_imgBtn groupBtn"/>
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="free_area0 xHuge_marginLIncl">
					<pretty:urlbuffer var="pageUrl" mappingId="viewPages">
						<f:param value="#{viewPages.volumeId}"/>
						<f:param value="#{viewPages.selectedPageNumber}"/>
					</pretty:urlbuffer>
					
					
					<h:outputText value="URL:" />
					<h:inputText styleClass="xHuge_txtInput" readonly="true" value="#{applicationBean.domain}#{requestScope.pageUrl}"/>

				</h:panelGroup>
			<!-- 
			<h:panelGroup layout="block" styleClass="medium_area0_p4 statusArea">
				<h:outputLink title="firstpic" value="">
					
				</h:outputLink>
			</h:panelGroup>
			-->
			<!-- 
			<h:panelGroup layout="block" styleClass="medium_area0_p4 statusArea" rendered="#{(ViewPages.selectedBook.type == 'M')}">
				<h:panelGroup styleClass="big_imgArea statusIcon virrMediaType#{ViewPages.selectedBook.type}"/>
				<span class="noDisplay">(</span>
					<h:outputLabel id="lblItemPublicState" styleClass="medium_label endline">
						<h:outputText value="#{lbl.view_dtls_genre_volume_txt}" rendered="#{(ViewPages.selectedBook.type == 'V')}" />
						<h:outputText value="#{lbl.view_dtls_genre_mono_txt}" rendered="#{(ViewPages.selectedBook.type == 'MG')}" />
						<h:outputText value="#{lbl.view_dtls_genre_multi_txt}" rendered="#{(ViewPages.selectedBook.type == 'M')}" />
					</h:outputLabel>
					<span class="noDisplay">)</span>
			</h:panelGroup>	
			-->
			</div>

<!-- 
			<div class="full_area0 itemBlock">
				<h:panelGroup styleClass="xTiny_area0 endline" >
					&#160;
				</h:panelGroup>
				<h:panelGroup styleClass="seperator" />
				<h:panelGroup styleClass="quad_area0 endline">
					&#160; <h:outputText value="#{lbl.view_faximile}" />
				</h:panelGroup>
				<h:panelGroup styleClass="seperator" />
				<h:panelGroup styleClass="quad_area0 endline">
					&#160; <h:outputText value="#{lbl.view_outline}" />
				</h:panelGroup>
			</div>
			-->
			
			
			
			<div class="full_area0 itemBlock noTopBorder">
				<span class="full_area0" style="position:relative; height:100em;">

						<!-- 
						<span class="double_area1 splitBlockHeader">
							<span class="double_area0_p4 endline itemHeadline">
								<b>
									Volume
								</b>
							</span>  
							<span class="double_area0_p4 lineToolSection">
								LineToolSection
							</span>
							
						</span>
						-->
						
						<span class="double_area0" style="position:absolute; z-index: 2;">		
							<rich:tabPanel id="tabPanel" switchType="ajax" activeItem="#{loginBean.tab}" itemChangeListener="#{loginBean.changeTab}">
				     			<rich:tab header="Toc" id="toc"  style="height:97em;overflow:auto" onmouseover="$('span.double_area0').width('40em'); $('span.double_area0').css('opacity','0.8')" onmouseout="$('span.double_area0').width('18.83em');$('span.double_area0').css('opacity','1');">
										<rich:tree toggleType="ajax" var="divItem" >
											<rich:treeModelRecursiveAdaptor  roots="#{viewPages.volume.teiSd.pbOrDiv}" nodes="#{divItem.pbOrDiv}">
												<rich:treeNode expanded="#{true}"  rendered="#{utilBean.getUnqualifiedClassName(divItem) != 'Pagebreak'}">
													<h:commandLink action="#{viewPages.goTo(divItem)}" style="#{divItem == viewPages.selectedDiv ? 'background-color:red;' : ''}">
														<h:outputText value="#{divItem.type}: " rendered="#{not empty divItem.type}"/>
														<h:outputText value="section: " rendered="#{empty divItem.type}"/>
														<f:ajax render="@all"/>
													</h:commandLink>
													<h:outputText value="#{divItem.head}" />
												</rich:treeNode>
										
												<ui:remove>
												<rich:treeNode expanded="#{true}" rendered="#{divItem.class.name!='Pagebreak'}" handleClass="test" >
													<h:commandLink action="#{viewPages.goTo(divItem)}" style="#{divItem == viewPages.selectedDiv ? 'background-color:red;' : ''}">
														<h:outputText value="#{divItem.type}: " rendered="#{not empty divItem.type}"/>
														<h:outputText value="section: " rendered="#{empty divItem.type}"/>
														<f:ajax render="@all"/>
													</h:commandLink>
													<h:outputText value="#{divItem.head}" />
												</rich:treeNode>
												</ui:remove>
											</rich:treeModelRecursiveAdaptor>
										</rich:tree>
								</rich:tab>
								<rich:tab header="Thumbs" id="thumbs">
									<load:lazyLoad pageList="#{viewPages}">
										<h:commandLink action="#{viewPages.goToPage(var)}">
											<h:graphicImage id="img" value="#{volumeUtilBean.getDigilibScalerUrlForPage(var,120,200)}" style="width:120px;" />
											<f:ajax render="@all"/>
										</h:commandLink>
									</load:lazyLoad>
								</rich:tab>
								<rich:tab header="Bibl. Metadata" id="bibmd" style="width:40em" onmouseover="$('span.double_area0').width('40em'); $('span.double_area0').css('opacity','0.8')" onmouseout="$('span.double_area0').width('18.83em');$('span.double_area0').css('opacity','1');">
									<mpdl:modsViewer modsMetadata="#{viewPages.volume.modsMetadata}"/>
								</rich:tab>
							</rich:tabPanel>
					
						</span>
		
				
				
				
					<h:panelGroup rendered="#{viewPages.viewType == 'SINGLE'}" style="margin-left:18.83em;position:absolute; z-index:1; float:right;">

						<link href="#{facesContext.externalContext.request.contextPath}/resources/components/digilib_jquery/jquery.digilib.css" type="text/css" rel="stylesheet" />

						<h:outputScript library="components/digilib_jquery" name="jquery.cookie.js" />
						<h:outputScript library="components/digilib_jquery" name="jquery.digilib.js" />
						<h:outputScript library="components/digilib_jquery" name="jquery.digilib.geometry.js" />
						<h:outputScript library="components/digilib_jquery" name="jquery.digilib.birdseye.js" />
						<h:outputScript library="components/digilib_jquery" name="jquery.digilib.regions.js" />
						<script type="text/javascript">
				            $(document).ready(function(){
				                var opts = {
				                	interactionMode : 'embedded',
				                    scalerBaseUrl : 'http://latest-coreservice.mpdl.mpg.de/digitallibrary/servlet/Scaler',
				                    showRegionNumbers : true,
				                    logoUrl: '',
				                    buttonSettings : {
				                        embedded : {
				                            'imagePath' : '#{facesContext.externalContext.request.contextPath}/resources/components/digilib_jquery/img/embedded/16/',
				                            'buttonSetWidth' : 18,
				                            'standardSet' : ["reference","zoomin","zoomout","zoomarea","zoomfull","reset","bird","toggleoptions"],
				                            'specialSet' : ["mark","delmark","hmir","vmir","rot","brgt","cont","rgb","quality","scale","lessoptions"],
				                            'arrowSet' : ["up", "down", "left", "right"],
				                            'buttonSets' : ['standardSet', 'specialSet']
				                            },
				                    },
				                    //scalerInset : -10
				                    
				                    };
				                var $div = $('div.digilib');
				                $div.digilib(opts);
				            });
				
				        </script>
						

						
						<span class="xHuge_area1 splitBlockHeader" style="width:70em;">
							<span class="xHuge_area0_p4 endline itemHeadline" >
								<h:outputText styleClass="xDouble_area0 xTiny_marginLExcl endline" value="#{viewPages.selectedPage.orderLabel}" />
								&#160;	
							</span>
							
							<span class="xHuge_area0_p4 lineToolSection">
								<h:outputLabel styleClass="free_label sectionTool" value="Seite #{viewPages.volume.pages.indexOf(viewPages.selectedPage)+1} #{lbl.toc_edit_of} #{utilBean.getListSize(viewPages.volume.pages)}"/>
							</span>
							
						</span>
						
						<div class="digilib xHuge_area1 splitBlockBody noTopBorder sameHeightMaster" style="width:70em;">
							<h:graphicImage value="#{volumeUtilBean.getDigilibScalerUrlForPage(viewPages.selectedPage,600,1400)}" style="cursor:pointer"/>
						</div>
						
					</h:panelGroup>
					
					
					
					
					
					
					
					
					<h:panelGroup rendered="#{viewPages.viewType == 'RECTO_VERSO' or viewPages.viewType == 'FULLTEXT'}" style="margin-left:18.83em; position:absolute; z-index:1; float:right;">
					
						<h:panelGroup styleClass="quad_area0" rendered="#{viewPages.selectedPage!=null}">
							<span class="quad_area1 splitBlockHeader">
								<span class="quad_area0_p4 endline itemHeadline">
									<h:outputText styleClass="xDouble_area0 xTiny_marginLExcl endline" value="#{viewPages.selectedPage.orderLabel}" />
									&#160;	
								</span>
								
								<span class="quad_area0_p4 lineToolSection">
									<h:outputLabel styleClass="free_label sectionTool" value="Seite #{viewPages.volume.pages.indexOf(viewPages.selectedPage)+1} #{lbl.toc_edit_of} #{lbl.toc_edit_of} #{utilBean.getListSize(viewPages.volume.pages)}"/>
								</span>
								
							</span>
							
							<div class="quad_area1 splitBlockBody noTopBorder sameHeightMaster digilib">
								<h:graphicImage styleClass="quad_area0" value="#{volumeUtilBean.getDigilibScalerUrlForPage(viewPages.selectedPage,360,1000)}" style="cursor:pointer"/>
							</div>
						</h:panelGroup>
						
						
						
						<h:panelGroup styleClass="quad_area0"  rendered="#{viewPages.viewType == 'RECTO_VERSO' and viewPages.selectedRightPage!=null}" >
							<span class="quad_area1 splitBlockHeader">
								<span class="quad_area0_p4 endline itemHeadline">
									<h:outputText styleClass="xDouble_area0 xTiny_marginLExcl endline" value="#{viewPages.selectedRightPage.orderLabel}" />
									&#160;	
								</span>
								
								<span class="quad_area0_p4 lineToolSection">
									<h:outputLabel styleClass="free_label sectionTool" value="Seite #{viewPages.volume.pages.indexOf(viewPages.selectedRightPage)+1} #{lbl.toc_edit_of} #{utilBean.getListSize(viewPages.volume.pages)}"/>
								</span>
								
							</span>
							
							<span class="quad_area1 splitBlockBody noTopBorder sameHeightMaster">
								<h:graphicImage styleClass="quad_area0" value="#{volumeUtilBean.getDigilibScalerUrlForPage(viewPages.selectedRightPage,360,1000)}" style="cursor:pointer"/>
							</span>
							
						</h:panelGroup>
					
						
						<h:panelGroup class="quad_area0"  rendered="#{viewPages.viewType == 'FULLTEXT'}">
							
							<span class="quad_area1 splitBlockHeader">
							<ui:remove>
								<span class="quad_area0_p4 endline itemHeadline">
									<b>
										Volume
									</b>
								</span>  
								<span class="quad_area0_p4 lineToolSection">
									LineToolSection
								</span>
								</ui:remove>
							</span>
							
							
							
							<div id="fulltext" class="quad_area1 splitBlockBody noTopBorder sameHeightSlave">
								<h:outputText value="#{viewPages.xhtmlForPage}" escape="false" rendered="#{viewPages.volume.tei!=null}"/>
							</div>
			
						</h:panelGroup>
					</h:panelGroup>
					
					
			</span>
			
		</div>
	</h:panelGroup>
		
		
		</ui:define>
	</ui:composition>

</html>
