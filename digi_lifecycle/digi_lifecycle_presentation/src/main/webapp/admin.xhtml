<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:mpdl="http://java.sun.com/jsf/composite/components/mpdl"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:pretty="http://ocpsoft.com/prettyfaces">

<ui:composition template="templates/template.xhtml">

	<h:outputStylesheet>

        .rf-p  {
            width: 500px;
        }
 


    </h:outputStylesheet>

	<ui:define name="mainContent">
		<h:form>
		<rich:panel layout="block" id="createdOUs" header="#{lbl.admin_ou_header}:" rendered="#{loginBean.login and loginBean.user.grants[0].properties.role.objid == 'escidoc:role-system-administrator'}">
			<a4j:repeat value="#{loginBean.user.createdOrgas}" var="orga">
				<pretty:link mappingId="ou">
					<f:param value="#{orga.id}" />
			    	<h:outputText value="#{orga.escidocMd.title}"/>
			    	
			    	<a4j:commandButton value="#{lbl.button_command_delete}" execute="@this" render="@none" oncomplete="#{rich:component('confirmOrgaPane')}.show()">
                    	<!-- <h:graphicImage value="/resources/images/Delete.png" alt="delete" /> -->
                   		<f:setPropertyActionListener target="#{adminBean.orga}" value="#{orga}" />
               		</a4j:commandButton> 
               		
               		<a4j:commandButton value="#{lbl.button_command_edit}" execute="@this" render="editOrga" oncomplete="#{rich:component('popup')}.show()">
                    	<a4j:param value="#{orga.id}" assignTo="#{adminBean.editOrgaId}" />
                   		<f:setPropertyActionListener target="#{adminBean.orga}" value="#{orga}" />
               		</a4j:commandButton> 
			    </pretty:link>
			   <br />
	      	</a4j:repeat>

            <a4j:commandButton execute="@this" value="#{lbl.admin_context_createNew}" render="editOrga" oncomplete="#{rich:component('popup')}.show()">
              	<f:setPropertyActionListener target="#{adminBean.orga}" value="#{adminBean.newEmptyOrga}" />
            </a4j:commandButton> 

    		<rich:popupPanel id="confirmOrgaPane" autosized="true"> 
    			 Are you sure you want to close this organization? (message)
        		<a4j:commandButton value="#{lbl.button_command_cancel}" onclick="#{rich:component('confirmOrgaPane')}.hide(); return false;" />
        		<a4j:commandButton value="#{lbl.button_command_delete}" action="#{adminBean.closeOrganization}"/>
    		</rich:popupPanel>
		    
   			<mpdl:ouEditor target="popup" organization="#{adminBean.orga}" command="#{adminBean.editOrga}"/>

		</rich:panel>
		
		<rich:panel layout="block" id="createdContexts" header="#{lbl.admin_context_header}:" rendered="#{loginBean.login and loginBean.user.grants[0].properties.role.objid == 'escidoc:role-ou-administrator'}" >
			<a4j:repeat value="#{loginBean.user.createdCollections}" var="collection">
				<pretty:link mappingId="volumes">
					<f:param value="#{collection.id}" />
			    	<h:outputText value="#{collection.name}"/>
			    	
				    <a4j:commandButton value="#{lbl.button_command_delete}" execute="@this" render="@none" oncomplete="#{rich:component('confirmCollectionPane')}.show()">
    	               	<f:setPropertyActionListener target="#{adminBean.collection}" value="#{collection}" />
        	       	</a4j:commandButton> 
               		
            	   	<a4j:commandButton value="#{lbl.button_command_edit}" execute="@this" render="editCollection" oncomplete="#{rich:component('popupContext')}.show()">
                	    <a4j:param value="#{collection.id}" assignTo="#{adminBean.editCollectionId}" />
                   		<f:setPropertyActionListener target="#{adminBean.collection}" value="#{collection}" />
               		</a4j:commandButton> 			    	
			    	
			    </pretty:link>
			   <br />
	      	</a4j:repeat>


    		<rich:popupPanel id="confirmCollectionPane" autosized="true"> 
    			 Are you sure you want to close this organization?
        		<a4j:commandButton value="#{lbl.button_command_cancel}" onclick="#{rich:component('confirmUserPane')}.hide(); return false;" />
        		<a4j:commandButton value="#{lbl.button_command_delete}" action="#{adminBean.closeCollection}"/>
    		</rich:popupPanel>		 	
		 	
            <a4j:commandButton execute="@this" value="#{lbl.admin_context_createNew}" render="editCollection" oncomplete="#{rich:component('popupContext')}.show()">
              	<f:setPropertyActionListener target="#{adminBean.collection}" value="#{adminBean.newEmptyCollection}" />
            </a4j:commandButton> 


   			<mpdl:contextEditor target="popupContext" title="#{lbl.admin_context_createNew}" collection="#{adminBean.collection}" />

		</rich:panel>

		<rich:panel layout="block" id="createdUAs" header="#{lbl.admin_user_header}:" rendered="#{loginBean.login}">
			<a4j:repeat value="#{loginBean.user.createdUsers}" var="user">
			    <h:outputText value=" #{lbl.admin_user_loginname}: #{user.loginName} "/>
			    <h:outputText value=" (#{lbl.admin_user_name}: #{user.name}) "/>

			    <a4j:commandButton value="#{lbl.button_command_delete}" execute="@this" render="@none" oncomplete="#{rich:component('confirmUserPane')}.show()">
                   	<f:setPropertyActionListener target="#{adminBean.user}" value="#{user}" />
               	</a4j:commandButton> 
               		
               	<a4j:commandButton value="#{lbl.button_command_edit}" execute="@this" render="editUser" oncomplete="#{rich:component('popupUser')}.show()">
                    <a4j:param value="#{user.id}" assignTo="#{adminBean.editUserId}" />
                   	<f:setPropertyActionListener target="#{adminBean.user}" value="#{user}" />
               	</a4j:commandButton> 
			   <br />
	      	</a4j:repeat>

    		<rich:popupPanel id="confirmUserPane" autosized="true"> 
    			 Are you sure you want to close this organization?
        		<a4j:commandButton value="#{lbl.button_command_cancel}" onclick="#{rich:component('confirmUserPane')}.hide(); return false;" />
        		<a4j:commandButton value="#{lbl.button_command_delete}" action="#{adminBean.deleteUser}" rendered="#{loginBean.login and loginBean.user.grants[0].properties.role.objid == 'escidoc:role-system-administrator'}"/>
        		<a4j:commandButton value="#{lbl.button_command_delete}" action="#{adminBean.deleteUser}" rendered="#{loginBean.login and loginBean.user.grants[0].properties.role.objid == 'escidoc:role-ou-administrator'}"/>
    		</rich:popupPanel>
		 
            <a4j:commandButton execute="@this" value="#{lbl.admin_user_createNew}" render="editUser" oncomplete="#{rich:component('popupUser')}.show()">
              	<f:setPropertyActionListener target="#{adminBean.user}" value="#{adminBean.newEmptyUser}" />
            </a4j:commandButton> 

   			<mpdl:userEditor target="popupUser" title="#{lbl.admin_user_createNew}" user="#{adminBean.user}" />

		</rich:panel>

	</h:form>

	</ui:define>


</ui:composition>

</html>
